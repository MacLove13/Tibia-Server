{"version":3,"file":"loop.js","sourceRoot":"/","sources":["server/loop.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,uDAAyC;AACzC,2CAAwC;AAExC,qDAAqD;AACrD,IAAI,cAA4B,CAAC;AACjC,IAAI,SAAS,GAAG,IAAI,KAAK,EAAS,CAAC;AAEnC,SAAgB,IAAI;IAChB,OAAO,CAAC,GAAG,CAAC,qBAAqB,CAAC,CAAC;IACnC,cAAc,GAAG,WAAW,CAAC,cAAc,EAAE,EAAE,CAAC,CAAC;IAEjD,sBAAsB;IACtB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QACxD,IAAI,QAAQ,GAAG,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QAC7C,IAAI,KAAK,GAAG,IAAI,aAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;QAChE,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACtB,SAAS,CAAC,CAAC,CAAC,CAAC,gBAAgB,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QAC9C,SAAS,CAAC,CAAC,CAAC,CAAC,iBAAiB,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;KACjD;AACL,CAAC;AAZD,oBAYC;AAED,SAAgB,IAAI;IAChB,IAAI,cAAc;QAAE,aAAa,CAAC,cAAmC,CAAC,CAAC;AAC3E,CAAC;AAFD,oBAEC;AAED,SAAS,cAAc;IACnB,SAAS,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC,GAAG,EAAE,EAAE;QAC1C,GAAG,CAAC,YAAY,EAAE,CAAC;QACnB,IAAI,GAAG,CAAC,MAAM,EAAE,EAAE;YACd,SAAS,CAAC,aAAa,CAAC,UAAU,CAAC,GAAG,CAAC,KAAK,EAAE,CAAC,CAAC;SACnD;IACL,CAAC,CAAC,CAAC;IAEH,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QACvC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC;KAC1B;AACL,CAAC","sourcesContent":["import * as GameState from \"@game/state\";\nimport { Spawn } from \"@game/mob/spawn\";\n\n// @ts-ignore - Ignore the following TypeScript error\nvar intervalHandle: NodeJS.Timer;\nvar spawnList = new Array<Spawn>();\n\nexport function Init() {\n    console.log(\"Server Loop Started\");\n    intervalHandle = setInterval(ServerInterval, 50);\n\n    // Load Mobs from Data\n    for (var i = 0; i < GameState.config.MobSpawns.length; i++) {\n        var mobSpawn = GameState.config.MobSpawns[i];\n        var spawn = new Spawn(mobSpawn.Position.x, mobSpawn.Position.y);\n        spawnList.push(spawn);\n        spawnList[i].MaintainMobCount(mobSpawn.Count);\n        spawnList[i].DefineMobsInSpawn(mobSpawn.Mobs);\n    }\n}\n\nexport function Stop() {\n    if (intervalHandle) clearInterval(intervalHandle as unknown as number);\n}\n\nfunction ServerInterval() {\n    GameState.characterList.ForEachPlayer((plr) => {\n        plr.AttackTarget();\n        if (plr.IsDead()) {\n            GameState.characterList.RemoveByID(plr.GetID());\n        }\n    });\n\n    for (var i = 0; i < spawnList.length; i++) {\n        spawnList[i].Process();\n    }\n}\n"]}